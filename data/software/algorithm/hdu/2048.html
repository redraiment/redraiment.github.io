<div title="2048 神、上帝以及老天爷" class="article-content">
<div class="sign">2008-06-11 20:04</div>
<h1>问题描述</h1>
<h2>Problem Description</h2>
<p>HDU 2006'10 ACM contest的颁奖晚会隆重开始了！</p>
<p>为了活跃气氛，组织者举行了一个别开生面、奖品丰厚的抽奖活动，这个活动的具体要求是这样的：</p>
<p>首先，所有参加晚会的人员都将一张写有自己名字的字条放入抽奖箱中；</p>
<p>然后，待所有字条加入完毕，每人从箱中取一个字条；</p>
<p>最后，如果取得的字条上写的就是自己的名字，那么“恭喜你，中奖了！”</p>
<p>大家可以想象一下当时的气氛之热烈，毕竟中奖者的奖品是大家梦寐以求的Twins签名照呀！不过，正如所有试图设计的喜剧往往以悲剧结尾，这次抽奖活动最后竟然没有一个人中奖！</p>
<p>我的神、上帝以及老天爷呀，怎么会这样呢？</p>
<p>不过，先不要激动，现在问题来了，你能计算一下发生这种情况的概率吗？</p>
<p>不会算？难道你也想以悲剧结尾？！</p>
<h2>Input</h2>
<p>输入数据的第一行是一个整数C,表示测试实例的个数，然后是C 行数据，每行包含一个整数n(1&lt;n&lt;=20),表示参加抽奖的人数。</p>
<h2>Output</h2>
<p>对于每个测试实例，请输出发生这种情况的百分比，每个实例的输出占一行, 结果保留两位小数(四舍五入)，具体格式请参照sample output。</p>
<h2>Sample Input</h2>
<pre>1
2</pre>
<h2>Sample Output</h2>
<pre>50.00%</pre>
<h1>问题分析</h1>
<h2>Problem Analyse</h2>
<p>递推题</p>
<h2>Algorithm Analyse</h2>
<p>神、上帝以及老天爷啊！就为了张Twins的签名照就这么大费周章的。唉~现在的年轻人啊。</p>
<p>N张票的所有排列可能自然是A<sup>n</sup><sub>n</sub> = N!种排列方式</p>
<p>现在的问题就是N张票的错排方式有几种。</p>
<p>首先我们考虑，如果前面N-1个人拿的都不是自己的票，即前N-1个人满足错排，现在又来了一个人，他手里拿的是自己的票。</p>
<p>只要他把自己的票与其他N-1个人中的任意一个交换，就可以满足N个人的错排。这时有N-1种方法。</p>
<p>另外，我们考虑，如果前N-1个人不满足错排，而第N个人把自己的票与其中一个人交换后恰好满足错排。</p>
<p>这种情况发生在原先N-1人中，N-2个人满足错排，有且仅有一个人拿的是自己的票，而第N个人恰好与他做了交换，这时候就满足了错排。</p>
<p>因为前N-1个人中，每个人都有机会拿着自己的票。所以有N-1种交换的可能。</p>
<p>综上所述：f(n) = (i - 1) * [f(n - 1) + f(n - 2)] </p>
<h1>参考源码</h1>
<pre><code data-language="c">#include &lt;math.h&gt;
#include &lt;stdio.h&gt;

int main(void)
{
  int i, n;
  __int64 d[21][2] = {{1,0},{1,0},{2,1},{6,2}};

  for (i = 4; i &lt; 21; i++)
  {
    d[i][0] = i * d[i-1][0];
    d[i][1] = (i - 1) * (d[i-1][1] + d[i-2][1]);
  }
  scanf("%d", &n);
  while (n-- && scanf("%d", &i))
    printf("%.2f%%\n", d[i][1]*100.0/d[i][0]);

  return 0;
}</code></pre>
</div>
